# Template file for 'vmware-horizon-client'
pkgname=vmware-horizon-client
_subver=17742757
version=8.2.0
revision=1
archs="x86_64"
wrksrc="VMware-Horizon-Client-Linux-2103-${version}-${_subver}"
depends="gstreamer1 libgstreamerd gst-plugins-base1 eudev-libudev libva"
short_desc="VMware Horizon Client for Linux"
maintainer="Alex Childs <misuchiru03+void@gmail.com>"
license="MIT"
homepage="https://www.vmware.com"
_vmwaresite="https://download3.vmware.com/software/view/viewclients/CART22FQ1"
distfiles="${_vmwaresite}/VMware-Horizon-Client-Linux-2103-${version}-${_subver}.tar.gz"
checksum=62f95bb802b058a98f5ee6c2296b89bd7e15884a24dc8a8ba7ce89de7e0798e4

pre_install() {
	cd x64
	find . -type f -name "*.tar.gz" -exec bsdtar xf {} \;
}

do_install() {
	# VMware-Horizon-Client-2103-${version}-${_subver}.x86_64
	for bin in x64/VMware-Horizon-Client-2103-${version}-${_subver}.x64/bin/*; do
		vbin ${bin}
	done
	for doc in x64/VMware-Horizon-Client-2103-${version}-${_subver}.x64/doc/*; do
		vdoc ${doc}
	done
	vmkdir usr
	vcopy x64/VMware-Horizon-Client-2103-${version}-${_subver}.x64/share usr/
	vcopy x64/VMware-Horizon-Client-2103-${version}-${_subver}.x64/lib usr/

	vcopy x64/VMware-Horizon-PCoIP-2103-${version}-${_subver}.x64/lib usr/

	for bin in x64/VMware-Horizon-USB-2103-${version}-${_subver}.x64/bin/*; do
		vbin ${bin}
	done

	vcopy x64/VMware-Horizon-html5mmr-2103-${version}-${_subver}.x64/lib usr/
	vcopy x64/VMware-Horizon-integratedPrinting-2103-${version}-${_subver}.x64/lib usr/ 
	vcopy x64/VMware-Horizon-scannerClient-2103-${version}-${_subver}.x64/lib usr/
	vcopy x64/VMware-Horizon-serialportClient-2103-${version}-${_subver}.x64/lib usr/

	vsv vmware-usbarbitrator

	vlicense x64/VMware-Horizon-Client-2103-${version}-${_subver}.x64/doc/open_source_licenses.txt LICENSE.txt
}

vmware-horizon-client-devel_package() {
	depends="${sourcepkg}>=${version}"
	short_desc+=" - development files"
	pkg_install() {
		vmkdir usr
		vcopy x64/VMware-Horizon-Client-Linux-ClientSDK-2103-${version}-${_subver}.x64/include usr/
	}
}
